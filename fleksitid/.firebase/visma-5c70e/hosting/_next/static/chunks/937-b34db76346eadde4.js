(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[937],{4085:function(e,t,r){Promise.resolve().then(r.bind(r,1019)),Promise.resolve().then(r.t.bind(r,423,23)),Promise.resolve().then(r.t.bind(r,3574,23))},5717:function(e,t,r){"use strict";r.d(t,{Z:function(){return AdminCheckBox}});var n=r(7437);r(2265);var a=r(7760),i=r(2582),s=r(182),l=r(4081);function AdminCheckBox(e){let{checked:t,onChange:r,label:d}=e;return(0,n.jsx)(l.Z,{component:"fieldset",children:(0,n.jsx)(i.Z,{"aria-label":"position",row:!0,children:(0,n.jsx)(s.Z,{value:"ErAdmin",control:(0,n.jsx)(a.Z,{checked:t,onChange:e=>{r(e.target.checked)},sx:{fontSize:"50px"}}),label:(0,n.jsx)("span",{style:{fontSize:"25px"},children:d}),labelPlacement:"start"})})})}},1019:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return FinnBrukerSkjema}});var n=r(7437),a=r(2265),i=r(7222),s=r(5577),l=r(148),d=r(4086),o=r(4033),u=r(1975),c=r(6895);let useResetFinnBrukerForm=e=>{a.useEffect(()=>{document.getElementById("AnsattNr").value=e.AnsattNr},[e])};function FinnBrukerTextField(e){let{formData:t,onChange:r}=e,a=(0,c.q)(r);return useResetFinnBrukerForm(t),(0,n.jsx)(s.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:1},mx:2},noValidate:!0,autoComplete:"off",children:(0,n.jsx)("div",{children:[{id:"AnsattNr",label:"AnsattNr",required:!0,variant:"filled"}].map(e=>(0,n.jsx)(u.Z,{required:e.required,id:e.id,label:e.label,variant:e.variant,onChange:a,value:t[e.id]},e.id))})})}var m=r(9050),f=r(8075),x=r(9804);function FinnBrukerErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Finner ikke bruker"})}function ButtonErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Fyll inn ansatt nummer"})}function FinnBrukerButton(e){let{onFind:t,isFormValid:r,onFormReset:i}=e,[s,l]=(0,a.useState)(!1);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(f.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,n.jsx)(m.Z,{variant:"contained",onClick:()=>{r?(t(),l(!1)):(console.log("valider ikke "+r),l(!0),setTimeout(()=>{l(!1)},3e3))},children:"Finn bruker"}),(0,n.jsx)(m.Z,{variant:"outlined",onClick:()=>{l(!1),i()},children:"Reset"})]}),(0,n.jsx)(ButtonErrorAlert,{vis:s})]})}let v={fontSize:"16px",fontWeight:"bold",color:"black"},p=[{id:"AnsattNr",label:"AnsattNr",variant:"filled"},{id:"Fornavn",label:"Fornavn",variant:"filled"},{id:"Etternavn",label:"Etternavn",variant:"filled"},{id:"Stilling",label:"Stilling",variant:"filled"},{id:"AntallJobbTimer",label:"Antall jobbtimer",type:"number",variant:"filled"},{id:"ErAdmin",label:"Adminbruker",type:"boolean",variant:"filled"}];function SlettBrukerTextField(e){let{formData:t}=e;return(0,n.jsx)(s.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:1},mx:2},noValidate:!0,autoComplete:"off",children:(0,n.jsx)("div",{children:p.map(e=>(0,n.jsx)(u.Z,{disabled:!0,id:e.id,label:e.label,variant:e.variant,type:e.type,value:t[e.id],InputProps:{style:v}},e.id))})})}function SlettBrukerButton(e){let{onDelete:t,handleFormReturn:r}=e;return(0,n.jsxs)(f.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,n.jsx)(m.Z,{variant:"outlined",onClick:()=>{r()},children:"Tilbake"}),(0,n.jsx)(m.Z,{variant:"contained",onClick:()=>{t()},children:"Slett bruker"})]})}function SlettetBrukerSuccsessAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"success",children:"Slettet bruker"})}function SlettBrukerSkjema(e){let{userData:t,onGoBack:r}=e,[o,u]=a.useState(t),[c,m]=a.useState(!1),handleSlettBruker=async()=>{console.log("Sletter data fra database:",o),await (0,d.oe)((0,d.JU)(l.db,l.N,o.AnsattNr)),m(!0),setTimeout(()=>{r()},3e3)};return(0,n.jsx)(s.Z,{sx:{width:.5},alignItems:"center",style:{margin:"auto"},children:(0,n.jsx)(s.Z,{display:"grid",gridTemplateColumns:"repeat(1fr, 1fr)",gap:2,alignItems:"center",style:{margin:"auto"},children:(0,n.jsx)(s.Z,{gridColumn:"span 1",children:(0,n.jsxs)(i.c,{children:[(0,n.jsx)(SlettBrukerTextField,{formData:o}),(0,n.jsx)(SlettBrukerButton,{onDelete:handleSlettBruker,handleFormReturn:()=>{r()}}),(0,n.jsx)(SlettetBrukerSuccsessAlert,{vis:c})]})})})})}var h=r(9946);let useFormOppdaterBrukerDataEffect=e=>{a.useEffect(()=>{document.getElementById("AnsattNr").value=e.AnsattNr,document.getElementById("Fornavn").value=e.Fornavn,document.getElementById("Etternavn").value=e.Etternavn,document.getElementById("Stilling").value=e.Stilling,document.getElementById("AntallJobbTimer").value=e.AntallJobbTimer;let t=document.getElementById("ErAdmin");t&&(t.checked=void 0!==e.ErAdmin&&e.ErAdmin)},[e])};var j=r(5729),b=r(5717);let g=[{id:"AnsattNr",label:"AnsattNr",required:!0,variant:"filled"},{id:"Fornavn",label:"Fornavn",required:!0,variant:"filled"},{id:"Etternavn",label:"Etternavn",required:!0,variant:"filled"},{id:"Stilling",label:"Stilling",required:!0,variant:"filled"},{id:"AntallJobbTimer",label:"Antall jobbtimer",type:"number",variant:"filled"}],B=[{id:"ErAdmin",label:"Adminbruker"}];function OppdaterBrukerForm(e){let{formData:t,onChange:r}=e,i=(0,c.q)(r);(0,h.Q)(t),useFormOppdaterBrukerDataEffect(t);let l=(0,j.B)(r),[d,o]=a.useState(!1);return a.useEffect(()=>{o(t.ErAdmin||!1)},[t.ErAdmin]),(0,n.jsx)(s.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:1},mx:2},noValidate:!0,autoComplete:"off",children:(0,n.jsxs)("div",{children:[g.map(e=>(0,n.jsx)(u.Z,{id:e.id,label:e.label,type:e.type||"text",autoComplete:e.autoComplete||"",required:e.required||!1,variant:e.variant||"filled",onChange:t=>{i(t),("Passord"===e.id||"GjentaPassord"===e.id)&&l(t)},value:t[e.id]},e.id)),(0,n.jsx)(b.Z,{checked:d,onChange:e=>{o(e),r({...t,ErAdmin:e})},label:B[0].label})]})})}function OppdatertBrukerSuccsessAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"success",children:"Oppdatert bruker"})}function OppdatertBrukerErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Ansatt nummer finnes fra f\xf8r"})}function OppdatertBrukerInfoAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"info",children:"Ingen ting er endret"})}function Alerts_ButtonErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Fyll inn alle feltene og passord m\xe5 matche"})}function OppdaterBrukerButton(e){let{onSave:t,isFormValid:r,onFormReturn:i,onByttPassord:s}=e,[l,d]=a.useState(!1);return(0,n.jsxs)("div",{children:[(0,n.jsx)(f.Z,{style:{marginBottom:"20px"},children:(0,n.jsx)(m.Z,{variant:"outlined",onClick:()=>{s(),d(!1)},children:"ByttPassord"})}),(0,n.jsxs)(f.Z,{direction:"row",spacing:2,justifyContent:"flex-end",children:[(0,n.jsx)(m.Z,{variant:"outlined",onClick:()=>{i(),d(!1)},children:"Tilbake"}),(0,n.jsx)(m.Z,{variant:"contained",onClick:()=>{r?(t(),d(!1)):(d(!0),setTimeout(()=>{d(!1)},3e3))},children:"Oppdater"})]}),(0,n.jsx)(Alerts_ButtonErrorAlert,{vis:l})]})}var k=r(9276);function ByttPassordSuccsessAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"success",children:"Passord endret"})}function ByttPassord_Alerts_ButtonErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Fyll inn alle feltene og passord m\xe5 matche"})}function HashingErrorAlert(e){let{vis:t}=e;return t&&(0,n.jsx)(x.Z,{severity:"error",children:"Noe feil skjedde, pr\xf8v p\xe5 nytt"})}let A=[{id:"Passord",label:"Passord",type:"password",autoComplete:"current-password",required:!0,variant:"filled"},{id:"GjentaPassord",label:"Gjenta Passord",type:"password",autoComplete:"current-password",required:!0,variant:"filled"}];function ByttPassordForm(e){let{formData:t,onChange:r}=e,a=(0,h.Q)(t),i=(0,j.B)(r);return(0,n.jsx)(s.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:1},mx:2},noValidate:!0,autoComplete:"off",children:(0,n.jsx)("div",{children:A.map(e=>(0,n.jsx)(u.Z,{id:e.id,label:e.label,type:e.type||"text",autoComplete:e.autoComplete||"",required:e.required||!1,variant:e.variant||"filled",onChange:e=>{i(e)},value:t[e.id],error:("Passord"===e.id||"GjentaPassord"===e.id)&&a,helperText:("Passord"===e.id||"GjentaPassord"===e.id)&&a?"Passord m\xe5 ha 6 nummer":""},e.id))})})}function ByttPassordButton(e){let{onSave:t,isFormValid:r,onFormReturn:i}=e,[s,l]=a.useState(!1);return(0,n.jsxs)("div",{children:[(0,n.jsxs)(f.Z,{direction:"row",spacing:2,justifyContent:"flex-center",children:[(0,n.jsx)(m.Z,{variant:"outlined",onClick:()=>{i(),l(!1)},children:"Tilbake"}),(0,n.jsx)(m.Z,{variant:"contained",onClick:()=>{r?(t(),l(!1)):(l(!0),setTimeout(()=>{l(!1)},3e3))},children:"Bytt Passord"})]}),(0,n.jsx)(ByttPassord_Alerts_ButtonErrorAlert,{vis:s})]})}var y=r(3226);function ByttPassordTittel(){return(0,n.jsx)(s.Z,{sx:{width:"100%",maxWidth:1e3,textAlign:"center",margin:"auto"},children:(0,n.jsx)(y.Z,{variant:"h1",sx:{fontSize:"2rem"},gutterBottom:!0,children:"Bytt Passord"})})}var S=r(9130);function ByttPassordSkjema(e){let{userData:t,onGoBack:r}=e,[o,u]=a.useState({...t,Passord:"",GjentaPassord:""}),[c,m]=a.useState(!1),[f,x]=a.useState(!1),handleSave=async()=>{console.log("Endrer passord i database");try{let e=await (0,S.Z)(o.Passord);await (0,d.pl)((0,d.JU)(l.db,l.N,o.AnsattNr),{Passord:e,SistEndret:(0,d.Bt)()},{merge:!0}),m(!0),setTimeout(()=>{r()},3e3)}catch(e){x(!0),m(!1),setTimeout(()=>{r()},3e3)}},v=o.Passord===t.Passord&&o.GjentaPassord===t.GjentaPassord||o.Passord.length===k.h&&o.Passord===o.GjentaPassord;return(0,n.jsx)(s.Z,{sx:{width:.5},alignItems:"center",justifyContent:"center",style:{margin:"auto"},children:(0,n.jsx)(s.Z,{display:"grid",gridTemplateColumns:"repeat(1fr, 1fr)",gap:2,alignItems:"center",style:{margin:"auto"},children:(0,n.jsx)(s.Z,{gridColumn:"span 1",children:(0,n.jsxs)(i.c,{children:[(0,n.jsx)(ByttPassordTittel,{}),(0,n.jsx)(ByttPassordForm,{formData:o,onChange:u}),(0,n.jsx)(ByttPassordButton,{onSave:handleSave,isFormValid:v,onFormReturn:()=>{console.log("Returnerer til oppdater bruker skjema"),r()}}),(0,n.jsx)(ByttPassordSuccsessAlert,{vis:c}),(0,n.jsx)(HashingErrorAlert,{vis:f})]})})})})}function OppdaterBrukerSkjema(e){let{userData:t,onGoBack:r}=e,[o,u]=a.useState(t);a.useEffect(()=>{u(t)},[t]),a.useEffect(()=>{let e=(0,d.JU)(l.db,l.N,t.AnsattNr),r=(0,d.cf)(e,e=>{if(e.exists()){let t=e.data().Passord;u(e=>({...e,Passord:t}))}});return()=>r()},[t.AnsattNr]);let[c,m]=a.useState(!1),[f,x]=a.useState(!1),[v,p]=a.useState(!1),[h,j]=a.useState(!1),handleSave=async()=>{let e=Object.keys(t).some(e=>t[e]!==o[e]);if(e){if(o.AnsattNr!==t.AnsattNr){let e=(0,d.JU)(l.db,l.N,o.AnsattNr),n=await (0,d.QT)(e);if(n.exists())x(!0),m(!1),p(!1);else{if(o.AntallJobbTimer!==t.AntallJobbTimer){let e=Number(o.AntallJobbTimer);o.Timebank=e}let n={...o,SistEndret:(0,d.Bt)(),Innlogget:!1};delete n.GjentaPassord,await (0,d.pl)(e,n);let a=(0,d.JU)(l.db,l.N,t.AnsattNr),i=await (0,d.QT)(a);i.exists()&&(await (0,d.oe)(a),console.log("Slettet gammelt dokument med ansattNr: ",t.AnsattNr)),m(!0),x(!1),p(!1),setTimeout(()=>{r()},3e3)}}else{let e=(0,d.JU)(l.db,l.N,t.AnsattNr);if(o.AntallJobbTimer!==t.AntallJobbTimer){let e=Number(o.AntallJobbTimer);o.Timebank=e}let n={...o,SistEndret:(0,d.Bt)(),Innlogget:!1};delete n.GjentaPassord,await (0,d.pl)(e,n),m(!0),x(!1),p(!1),setTimeout(()=>{r()},3e3)}}else p(!0),x(!1),m(!1),console.log("Ingen ting endret")},b=""!==o.AnsattNr&&""!==o.Fornavn&&""!==o.Etternavn&&""!==o.Stilling;return(0,n.jsx)(s.Z,{sx:{width:.5},alignItems:"center",style:{margin:"auto"},children:h?(0,n.jsx)(ByttPassordSkjema,{userData:t,onGoBack:()=>{j(!1)}}):(0,n.jsx)(s.Z,{display:"grid",gridTemplateColumns:"repeat(1fr, 1fr)",gap:2,alignItems:"center",style:{margin:"auto"},children:(0,n.jsx)(s.Z,{gridColumn:"span 1",children:(0,n.jsxs)(i.c,{children:[(0,n.jsx)(OppdaterBrukerForm,{formData:o,onChange:u}),(0,n.jsx)(OppdaterBrukerButton,{onSave:handleSave,isFormValid:b,onFormReturn:()=>{r()},onByttPassord:()=>{j(!0),p(!1),x(!1),m(!1)}}),(0,n.jsx)(OppdatertBrukerSuccsessAlert,{vis:c}),(0,n.jsx)(OppdatertBrukerErrorAlert,{vis:f}),(0,n.jsx)(OppdatertBrukerInfoAlert,{vis:v})]})})})})}function FinnBrukerSkjema(){let[e,t]=a.useState({AnsattNr:""}),[r,u]=a.useState(null),[c,m]=a.useState(!1),[f,x]=a.useState(!1),[v,p]=a.useState(!1),h=(0,o.usePathname)(),handleFinnBruker=async()=>{let t=(0,d.JU)(l.db,l.N,e.AnsattNr),r=await (0,d.QT)(t);if(r.exists()){let e=r.data();e.GjentaPassord=e.Passord,u(e),"/admin/slettBruker"===h?m(!0):"/admin/oppdaterBruker"===h&&x(!0)}else p(!0),setTimeout(()=>{p(!1)},3e3)},handleFormReset=()=>{t({AnsattNr:""}),u(null),m(!1),x(!1),p(!1)},j=""!==e.AnsattNr;return(0,n.jsx)(s.Z,{sx:{width:.5},alignItems:"center",style:{margin:"auto"},children:c?(0,n.jsx)(SlettBrukerSkjema,{userData:r,onGoBack:handleFormReset}):f?(0,n.jsx)(OppdaterBrukerSkjema,{userData:r,onGoBack:handleFormReset}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(i.c,{children:[(0,n.jsx)(FinnBrukerTextField,{formData:e,onChange:t}),(0,n.jsx)(FinnBrukerButton,{onFind:handleFinnBruker,isFormValid:j,onFormReset:handleFormReset}),(0,n.jsx)(FinnBrukerErrorAlert,{vis:v})]})})})}},9276:function(e,t,r){"use strict";r.d(t,{h:function(){return c},Z:function(){return NyBrukerForm}});var n=r(7437),a=r(2265),i=r(5577),s=r(1975),l=r(9946),d=r(6895);let useFormDataEffect=e=>{a.useEffect(()=>{document.getElementById("AnsattNr").value=e.AnsattNr,document.getElementById("Fornavn").value=e.Fornavn,document.getElementById("Etternavn").value=e.Etternavn,document.getElementById("Stilling").value=e.Stilling,document.getElementById("AntallJobbTimer").value=e.AntallJobbTimer,document.getElementById("Passord").value=e.Passord,document.getElementById("GjentaPassord").value=e.GjentaPassord;let t=document.getElementById("ErAdmin");t&&(t.checked=void 0!==e.ErAdmin&&e.ErAdmin)},[e])};var o=r(5729),u=r(5717);let c=6,m=[{id:"AnsattNr",label:"AnsattNr",required:!0,variant:"filled"},{id:"Fornavn",label:"Fornavn",required:!0,variant:"filled"},{id:"Etternavn",label:"Etternavn",required:!0,variant:"filled"},{id:"Stilling",label:"Stilling",required:!0,variant:"filled"},{id:"AntallJobbTimer",label:"Antall jobbtimer i uka",type:"number",variant:"filled"},{id:"Passord",label:"Passord",type:"password",autoComplete:"current-password",required:!0,variant:"filled"},{id:"GjentaPassord",label:"Gjenta Passord",type:"password",autoComplete:"current-password",required:!0,variant:"filled"}],f=[{id:"ErAdmin",label:"Adminbruker"}];function NyBrukerForm(e){let{formData:t,onChange:r}=e,c=(0,d.q)(r),x=(0,l.Q)(t);useFormDataEffect(t);let v=(0,o.B)(r),[p,h]=a.useState(t.ErAdmin||!1);return a.useEffect(()=>{h(t.ErAdmin||!1)},[t.ErAdmin]),(0,n.jsx)(i.Z,{component:"form",sx:{"& .MuiTextField-root":{m:1,width:1},mx:2},noValidate:!0,autoComplete:"off",children:(0,n.jsxs)("div",{children:[m.map(e=>(0,n.jsx)(s.Z,{id:e.id,label:e.label,type:e.type||"text",autoComplete:e.autoComplete||"",required:e.required||!1,variant:e.variant||"filled",onChange:t=>{c(t),("Passord"===e.id||"GjentaPassord"===e.id)&&v(t)},value:t[e.id],error:("Passord"===e.id||"GjentaPassord"===e.id)&&x,helperText:("Passord"===e.id||"GjentaPassord"===e.id)&&x?"Passord m\xe5 ha lengde 6":""},e.id)),(0,n.jsx)(u.Z,{checked:p,onChange:e=>{h(e),r({...t,ErAdmin:e})},label:f[0].label})]})})}},9130:function(e,t,r){"use strict";var n=r(4866),a=r.n(n);let bcryptHashing=async e=>{try{let t=await a().genSalt(10),r=await a().hash(e,t);return r}catch(e){throw e}};t.Z=bcryptHashing},148:function(e,t,r){"use strict";r.d(t,{N:function(){return l},db:function(){return s}});var n=r(994),a=r(4086);let i=(0,n.ZF)({apiKey:"AIzaSyDXAV7xZr-ztj97FSL3oOhaUqsIiqfR2fk",authDomain:"visma-5c70e.firebaseapp.com",projectId:"visma-5c70e",storageBucket:"visma-5c70e.appspot.com",messagingSenderId:"161477454641",appId:"1:161477454641:web:7abeb57872fb86ef719e10"}),s=(0,a.ad)(i),l="Brukere"},7222:function(e,t,r){"use strict";r.d(t,{c:function(){return i}});var n=r(5843),a=r(6055);let i=(0,n.ZP)(a.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(1),textAlign:"center"}})},6895:function(e,t,r){"use strict";r.d(t,{q:function(){return useFormUpdate}});let useFormUpdate=e=>t=>{let{id:r,value:n}=t.target;e(e=>({...e,[r]:n}))}},9946:function(e,t,r){"use strict";r.d(t,{Q:function(){return useFormValidation}});var n=r(2265),a=r(9276);let useFormValidation=e=>{let[t,r]=n.useState(!1),isNumeric=e=>/^[0-9]+$/.test(e);return n.useEffect(()=>{let t=e.AnsattNr&&e.Fornavn&&e.Etternavn&&e.Stilling&&isNumeric(e.Passord)&&isNumeric(e.GjentaPassord)&&e.Passord===e.GjentaPassord&&e.Passord.length===a.h;r(!t)},[e]),t}},5729:function(e,t,r){"use strict";r.d(t,{B:function(){return usePassordEndring}});let usePassordEndring=e=>t=>{let{id:r,value:n}=t.target,a=/^[0-9]*$/.test(n);e(e=>({...e,[r]:a?n:""}))}},4033:function(e,t,r){e.exports=r(94)}}]);