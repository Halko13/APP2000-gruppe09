(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{35525:function(n,e,t){Promise.resolve().then(t.bind(t,55460))},55460:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return page}});var r=t(57437),i=t(24033),a=t(2265),o=t(69987),d=t(43226),l=t(49050),s=t(59189),components_AnsattInnlogging=n=>{let{valgtBrukerNavn:e,pin:t,håndterPinEndring:i,håndterInnlogin:a}=n;return(0,r.jsxs)("form",{onSubmit:a,children:[(0,r.jsx)(d.Z,{variant:"h5",gutterBottom:!0,children:e}),(0,r.jsx)(s.Z,{fullWidth:!0,id:"pin",type:"password",label:"PIN-kode",placeholder:"PIN-kode",margin:"normal",value:t,onChange:i}),(0,r.jsx)(l.Z,{variant:"contained",type:"submit",fullWidth:!0,children:"Logg inn"})]})},components_AdminInnlogging=n=>{let{adminBruker:e,vedPassordEndring:t,vedLoginKlikk:i,passord:a}=n;return(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Z,{variant:"h6",children:e.brukernavn}),(0,r.jsx)(s.Z,{fullWidth:!0,type:"password",label:"Password",placeholder:"Enter your password",margin:"normal",value:a,onChange:t}),(0,r.jsx)(l.Z,{variant:"contained",onClick:i,fullWidth:!0,style:{marginTop:"20px"},children:"Logg inn som admin"})]})},c=t(28874),components_NummerPad=n=>{let{vedNumKlikk:e,vedSlett:t,vedEnter:i}=n,håndterNummerKlikk=n=>{"⌫"===n?t():"✓"===n?i():e(n)};return(0,r.jsx)(c.ZP,{container:!0,spacing:1,children:["1","2","3","4","5","6","7","8","9","⌫","0","✓"].map(n=>(0,r.jsx)(c.ZP,{item:!0,xs:4,children:(0,r.jsx)(l.Z,{variant:"outlined",onClick:()=>håndterNummerKlikk(n),sx:{width:"100%",height:"64px",fontSize:"24px"},children:n})},n))})};t(67148);var u=t(34984),m=t(70148),h=t(24086),g=t(14866),v=t.n(g);let bcryptVerify=async(n,e)=>{try{let t=await v().compare(n,e);return t}catch(n){throw n}};var page=()=>{var n,e,t,s,c,g;let v=(0,i.useRouter)(),[k,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[b,w]=(0,a.useState)("VelgBrukerListe"),[Z,E]=(0,a.useState)(""),[I,S]=(0,a.useState)(!1),[B,P]=(0,a.useState)([]),[_,L]=(0,a.useState)([]);(0,a.useEffect)(()=>{let hentBrukere=async()=>{let n=(0,h.hJ)(m.db,"Brukere"),e=await (0,h.PL)(n),t=e.docs.map(n=>({id:n.id,...n.data()}));P(t);let r=t.filter(n=>n.erAdmin);L(r)};hentBrukere()},[]),(0,a.useEffect)(()=>{let n=localStorage.getItem("brukerId");n&&p(n)},[]);let håndterPinKodeEndring=n=>{x(n.target.value)},A=(0,a.useCallback)(async()=>{let n=B.find(n=>n.id===k);if(n){let e=await bcryptVerify(f,n.Passord);n.ErAdmin&&e?(j("Logget inn som admin. Velkommen "+n.Fornavn+"!"),window.location.href="/admin"):!n.ErAdmin&&e?(j("Logget inn. Velkommen ".concat(n.Fornavn," ").concat(n.Etternavn,"!")),v.push("dashboard/".concat(k,"/sjekkinn"))):j("Innlogging feilet. Feil navn eller pin kode!")}},[B,k,f,j,v]),håndterInnlogin=n=>{n.preventDefault(),A()};return(0,a.useEffect)(()=>{let håndterTaseTrykk=n=>{n.key>="0"&&n.key<="9"?x(e=>e+n.key):"Enter"===n.key?A():"Backspace"===n.key&&x(n=>n.slice(0,-1))};return window.addEventListener("keydown",håndterTaseTrykk),()=>{window.removeEventListener("keydown",håndterTaseTrykk)}},[f,A]),(0,r.jsx)(o.Z,{theme:u.Z,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(d.Z,{variant:"h2",gutterBottom:!0,children:["Velkommen"," ",I?null===(n=_.find(n=>n.brukernavn===k))||void 0===n?void 0:n.brukernavn:"".concat(null===(e=B.find(n=>n.id===k))||void 0===e?void 0:e.Fornavn," \n                ").concat(null===(t=B.find(n=>n.id===k))||void 0===t?void 0:t.Etternavn)]}),(0,r.jsxs)(d.Z,{variant:"h5",gutterBottom:!0,children:["Logget p\xe5 som:"," ",I?(null===(s=_.find(n=>n.brukernavn===k))||void 0===s?void 0:s.brukernavn)||"Ukjent Admin":"".concat(null===(c=B.find(n=>n.id===k))||void 0===c?void 0:c.Fornavn," \n                ").concat(null===(g=B.find(n=>n.id===k))||void 0===g?void 0:g.Etternavn)||"Ukjent Bruker"]}),I?(0,r.jsx)("div",{children:(0,r.jsx)(components_AdminInnlogging,{adminBruker:_,passord:f,vedPassordEndring:håndterPinKodeEndring,vedLoginKlikk:håndterInnlogin})}):(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Z,{variant:"h4",gutterBottom:!0,style:{marginTop:"50px"},children:"For skjerminnlogging"}),(0,r.jsx)(components_NummerPad,{vedNumKlikk:n=>{x(e=>e+n)},vedSlett:()=>{x(n=>n.slice(0,-1))},vedEnter:()=>{håndterInnlogin()}}),(0,r.jsx)(components_AnsattInnlogging,{pin:f,håndterPinnEndring:håndterPinKodeEndring,håndterInnlogin:håndterInnlogin})]})]}),(0,r.jsx)(l.Z,{variant:"contained",color:"primary",fullWidth:!0,onClick:()=>{"VelgBrukerListe"!==b?w(Z):window.location.href="/"},style:{marginTop:75},children:"G\xe5 tilbake til hovedsiden"}),y&&(0,r.jsx)(d.Z,{variant:"h5",style:{marginTop:"15px"},children:y})]})})}},67148:function(n,e,t){"use strict";t(57437),t(2265)},34984:function(n,e,t){"use strict";t(2265);var r=t(23113),i=t(8652);let a=(0,r.Z)({palette:{primary:{main:i.Z[500]},secondary:{main:i.Z[300]}}});e.Z=a},70148:function(n,e,t){"use strict";t.d(e,{N_:function(){return d},S2:function(){return l},db:function(){return o},e_:function(){return s}});var r=t(20994),i=t(24086);let a=(0,r.ZF)({apiKey:"AIzaSyDXAV7xZr-ztj97FSL3oOhaUqsIiqfR2fk",authDomain:"visma-5c70e.firebaseapp.com",projectId:"visma-5c70e",storageBucket:"visma-5c70e.appspot.com",messagingSenderId:"161477454641",appId:"1:161477454641:web:7abeb57872fb86ef719e10"}),o=(0,i.ad)(a),d="Brukere",l="AdminBrukere",s="Stempling"}},function(n){n.O(0,[358,218,187,777,659,99,214,189,55,417,971,472,744],function(){return n(n.s=35525)}),_N_E=n.O()}]);